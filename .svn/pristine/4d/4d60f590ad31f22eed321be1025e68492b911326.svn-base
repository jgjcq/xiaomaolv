<?phpdefined('BASEPATH') OR exit('No direct script access allowed');?><!DOCTYPE html><html><head>    <?php    include_once 'public/views/home/header.php';    ?>    <link href="cust/js/H5-audio/css/audio.css" rel="stylesheet" type="text/css" />    <script type="text/javascript" src="cust/js/H5-audio/js/audio.js"></script>    <style type="text/css">        .imgRad{            margin:0 auto;            background: darkcyan;            width:200px;            height:200px;            border:2px solid darkslategray;            border-radius:30px;            text-align: center;            line-height: 200px;        }        .my-course-list-price{            position: relative;            padding-top: 1rem;            box-sizing: border-box;            display: -webkit-box;            display: -webkit-flex;            display: flex;            -webkit-box-pack: justify;            -webkit-justify-content: space-between;            justify-content: space-between;            -webkit-box-align: center;            -webkit-align-items: center;            align-items: center;            padding-top: 3rem;        }        .jdt-container {            width: 10rem;            background-color: #ddd;            border-radius:1.25rem;        }        .skills {            text-align: right;            line-height: 0.5rem;        }        .jd {background-color: #FFBA00; border-radius:1.25rem;}        .item-after:after {            content: '';            position: absolute;            left: 0;            bottom: 0;            right: auto;            top: auto;            height: 1px;            width: 100%;            background-color: #e1e1e1;            display: block;            z-index: 15;            -webkit-transform-origin: 50% 100%;            transform-origin: 50% 100%;        }    </style></head><body><div class="page-group">    <div class="page page-current">        <!-- 标题栏 -->        <header class="bar bar-nav">            <a class="button button-link button-nav pull-left back" >                <span class="icon icon-left"></span>                返回            </a>            <a class="icon icon-refresh pull-right"></a>            <h1 class="title">我的课程</h1>        </header>        <!-- 工具栏 -->        <nav class="bar bar-tab">            <a class="tab-item external " href="Home">                <span class="icon dh_sy" ></span>                <span class="tab-label">首页</span>            </a>            <a class="tab-item external active" href="Home/myCourse">                <span class="icon dh_wdkc1"></span>                <span class="tab-label">我的课程</span>            </a>            <a class="tab-item external " href="Home/my">                <span class="icon dh_grzx"></span>                <span class="tab-label">个人中心</span>            </a>        </nav>        <!-- 这里是页面内容区 -->        <div class="content" style="top: 0;">            <div class="video-main" style="background: #fff">                <img src="<?=estr($detail,'article_image')?>" style="width: 100%;height:9rem;padding: 0.8rem;border-radius: 30px">            </div>            <div  style="background: #fff;padding: 0rem 0 .8rem 1rem">                <?=estr($detail,'title')?>            </div>            <div class="card" style="margin-left: 0rem;margin-right: 0rem">                <div class="card-header" style="padding-top: 0.5rem;padding-left: .5rem">                    <div style="text-align: center; display: table;">                        <i class="iconfont icon-shuben011">                            <img width="75%" src="cust/images/课程列表.png" alt="">                        </i>                        <span style="vertical-align: middle; display: table-cell;padding-left:0.5rem">课程列表</span></div>                </div>                <?php                $index = 0;                foreach($detail_list as $info){                ?>                <div class="card-content " >                    <div class="row" style="padding-left: 0.5rem;padding-top: 0.5rem;">                        <div class="col-75" style="padding-left: 2.5%"> <?=estr($info,"title")?></div>                        <div class="col-25" style="color:rgba(0, 0, 0, 0.3)">                            <span class="changeVideo" id="changeVideo<?=$index?>"><?php                                if(estr($info,'is_over') == 1){                                    echo "已看完";                                }else{                                    echo  "已播放",round($info['now_time']/$info["total_time"]*100),"%";                                }                                ?></span>                            <span class="videoOver" style="display: none">                                            正在播放                                        </span>                        </div>                    </div>                    <div class="row" style="padding-left: 15px;padding-top: 20px;padding-bottom: 20px">                        <div class="col-75 ">                            <div class="audio-wrapper" style="height: 1rem">                                <audio id="audio<?=$index?>" data-info="<?=$index?>" data-nowid="<?=$info['id']?>" data-currentTime="<?=$info['now_time']?>" data-duration="<?=$info['total_time']?>">                                    <source src="<?=estr($info,"url")?>" type="audio/mp3">                                </audio>                                <div class="progress-bar-bg" id="progressBarBg<?=$index?>">                                    <span id="progressDot<?=$index?>"></span>                                    <div class="progress-bar" id="progressBar<?=$index?>"></div>                                </div>                                <div class="audio-time" style="margin-top: 8px;margin-left: -6px">                                    <span class="audio-length-current " id="audioCurTime<?=$index?>" >00:00</span>                                    <span class="audio-length-total"><?php echo date("i:s",$info['times']) ?></span>                                </div>                            </div>                        </div>                        <div class="col-25 " >                            <div class="audio-left" style="float:right;width: 85%;margin-top: -7px" >                            <img id="audioPlayer<?=$index++?>" src="cust/js/H5-audio/image/play.png">                            </div>                            </div>                    </div>                </div>                <?php                }?>            </div>            <div style="width: 100%;text-align: center;letter-spacing: 1px;color: #acacac">                没有更多了~            </div>        </div>        </div>    </div>    <?php    include_once 'public/views/home/script.php';    ?><script type="text/javascript">    var clearTime ;    function setHit(id,now){        var url="Home/myCourse/setHit/"+id+"/"+Math.round(now);        $.getJSON(url,function (data) {            console.log(data)        })    }    // 获取所有audios    var audios = document.getElementsByTagName("audio");    $.each(audios,function () {        $(this).on("play",function () {            var that = this;            var nowPlay = $(that).data("nowid");            if(clearTime)                window.clearInterval(clearTime);            clearTime =window.setInterval(function () {                setHit(nowPlay,that.currentTime);                console.log(nowPlay+"|"+that.currentTime);            },3000);        });        $(this).on("ended",function () {            var nowPlay = $(that).data("nowid");            window.clearInterval(clearTime);            setHit(nowPlay,-1);        });        $(this).on("timeupdate",function () {            var c = $(this).data('currenttime');            var d = $(this).data('duration');            var index = $(this).data('info');            if(c < d){                if(this.currentTime <this.duration ){                    var bfb = Math.round(this.currentTime/this.duration*100) +"%";                    $('#changeVideo'+index).text("已播放"+bfb);                }else{                    $('#changeVideo'+index).text("已播完");                }            }        });        $(this).on("pause",function () {            window.clearInterval(clearTime);        });    })    // 暂停函数    function pauseAll() {        var self = this;        [].forEach.call(audios, function (i) {            if(i !== self){                i.pause();                var index = $(i).data("info");                var audioPlayer = document.getElementById('audioPlayer'+index);                audioPlayer.src = 'cust/js/H5-audio/image/play.png';            }        })    }    // 给play事件绑定暂停函数    [].forEach.call(audios, function (i) {        i.addEventListener("play", pauseAll.bind(i));    })</script></body></html>